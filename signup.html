<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signup</title>

    <!-- Base CSS -->
    <link rel="stylesheet" href="css/base.css" />

    <!-- Font awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />

    <style>
      body {
        background: var(--background-small);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.6rem;
      }

      .signup-box {
        width: 380px;
        background: var(--background-white);
        padding: 24px;
        border-radius: 8px;
        box-shadow: var(--box-shadow);
      }

      .signup-box h2 {
        text-align: center;
        margin-bottom: 20px;
      }

      .form-control {
        margin-bottom: 16px;
      }

      .form-control input {
        width: 100%;
        padding: 10px;
        border-radius: 6px;
        border: 1px solid #ddd;
        font-size: 1.5rem;
        text-transform: none;
      }

      .form-control.error input {
        border-color: var(--text-orange);
      }

      .form-control small {
        display: block;
        min-height: 16px;
        font-size: 1.3rem;
        color: var(--text-orange);
        margin-top: 4px;
        opacity: 0;
      }

      .form-control.error small {
        opacity: 1;
      }

      .btn-signup {
        width: 100%;
        padding: 10px;
        border-radius: 6px;
        background: var(--text-blue);
        color: #fff;
        font-size: 1.6rem;
        cursor: pointer;
      }

      .btn-signup:hover {
        opacity: 0.9;
      }
    </style>
  </head>

  <body>
    <form class="signup-box" id="signupForm">
      <h2>Đăng ký</h2>

      <div class="form-control">
        <input type="text" id="email" placeholder="Email" />
        <small></small>
      </div>

      <div class="form-control">
        <input type="password" id="password" placeholder="Mật khẩu" />
        <small></small>
      </div>

      <div class="form-control">
        <input
          type="password"
          id="confirmPassword"
          placeholder="Nhập lại mật khẩu"
        />
        <small></small>
      </div>

      <button class="btn-signup" type="submit">Đăng ký</button>

      <div style="margin-top: 12px; text-align: center">
        <a href="login.html" style="font-size: 1.4rem; color: var(--text-blue)">
          → Đã có tài khoản? Đăng nhập
        </a>
      </div>
    </form>

    <script>
      const form = document.getElementById("signupForm");
      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");
      const confirmInput = document.getElementById("confirmPassword");

      function showError(input, message) {
        const formControl = input.parentElement;
        formControl.classList.add("error");
        formControl.querySelector("small").innerText = message;
      }

      function clearError(input) {
        const formControl = input.parentElement;
        formControl.classList.remove("error");
        formControl.querySelector("small").innerText = "";
      }

      function isValidEmail(email) {
        const regex = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
        return regex.test(email);
      }

      [emailInput, passwordInput, confirmInput].forEach((input) => {
        input.addEventListener("input", () => clearError(input));
      });

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        let isError = false;

        const email = emailInput.value.trim();
        const password = passwordInput.value.trim();
        const confirmPassword = confirmInput.value.trim();

        if (email === "") {
          showError(emailInput, "Vui lòng nhập email");
          isError = true;
        } else if (!isValidEmail(email)) {
          showError(emailInput, "Email không hợp lệ");
          isError = true;
        }

        if (password === "") {
          showError(passwordInput, "Vui lòng nhập mật khẩu");
          isError = true;
        } else if (password.length < 6) {
          showError(passwordInput, "Mật khẩu tối thiểu 6 ký tự");
          isError = true;
        }

        if (confirmPassword === "") {
          showError(confirmInput, "Vui lòng nhập lại mật khẩu");
          isError = true;
        } else if (confirmPassword !== password) {
          showError(confirmInput, "Mật khẩu không khớp");
          isError = true;
        }

        if (!isError) {
          // Lưu user vào localStorage (giả lập database)
          localStorage.setItem(
            "userAccount",
            JSON.stringify({
              email,
              password,
              createdAt: new Date().toISOString(),
            })
          );

          alert("Đăng ký thành công! Vui lòng đăng nhập.");
          window.location.href = "login.html";
        }
      });
    </script>
  </body>
</html>
